<div class="container">

<table style="width: 100%;"><tr>
<td>PeptideSpectrum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Annotated Peptide Fragmentation Mass Spectrum</h2>

<h3>Description</h3>

<p>Identify the b- and y-ions or c- and z-ions in a peptide fragmentation mass spectrum given the sequence.  Generate a plot and table identifying the fragment ions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PeptideSpectrum(expt, theory, t = 0.4, b = 5, label = "", xlim = c(100, 1500), 
                supress = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expt</code></td>
<td>
<p>data frame containing the experimental MS/MS peak list with the m/z values in the first column and corresponding intensities in the second</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theory</code></td>
<td>
<p>data frame of theoretical fragment ions generated by <code>FragmentPeptide</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>numeric value specifying the m/z tolerance for matching theoretical fragment ions to experimental peaks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>numeric value specifying the baseline threshold for peak identification.  Expressed as a percent of the maximum intensity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>character string to label the spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>numeric vector of length 2, defining the beginning and ending values of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supress</code></td>
<td>
<p>logical specifying whether or not to supress the peak annotations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A graphics window of width = 10 and height = 5.5 seems to work well.  A crude attempt is made to prevent overlapping peak annotations.  If this is unsuccessful, use <code>supress = TRUE</code> and then add the annotations using the <code>text</code> function.  If two or more peak identifications are made within the set tolerance, all identifications will be printed, overlapping, on the plot.
</p>


<h3>Value</h3>

<p>Generates an annotated spectrum and a data frame showing the matches between the experimental peaks and the theoretical fragment ions.  The column names refer to the experimental <em>m/z</em> value (<code>expt_mz</code>), the experimental peak intensity (<code>expt_int</code>) and the error between the experimental and theoretical <em>m/z</em> values (<code>error</code>).  The other column names are the same as for <code>FragmentPeptide</code>.
</p>


<h3>Author(s)</h3>

<p>Nathan G. Dodder</p>


<h3>See Also</h3>

<p><code>FragmentPeptide</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## plot spectrum of peptide NIDALSGMEGR
t &lt;- FragmentPeptide("NIDALSGMEGR")   # generate theoretical fragment ions
PeptideSpectrum(example.spectrum.peptide, t, label = "CID", xlim = c(100, 1200))
mtext("Peptide fragmentation mass spectrum", line = 1)
</code></pre>


</div>