<div class="container">

<table style="width: 100%;"><tr>
<td>consensus_detection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remove ambiguous detections</h2>

<h3>Description</h3>

<p><code>consensus_detection</code> removes ambiguous detections
</p>


<h3>Usage</h3>

<pre><code class="language-R">consensus_detection(detection, by = "overlap", filter = "max", cores = 1, pb = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>detection</code></td>
<td>
<p>Data frame or selection table (using the warbleR package's format, see <code>selection_table</code>) with the output of <code>label_detection</code> containing the start and end of the signals. Must contained at least the following columns: "sound.files", "selec", "start", "end" and "detection.class" (the last one is generated by <code>label_detection</code>). It must also contained the column indicated in the 'by' argument (which is 'overlap' by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>Character vector of length 1 indicating a column in 'detection' that will be used to filter detections. Must refer to a numeric column. Default is 'overlap', which is return by <code>label_detection</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>Character vector of length 1 indicating the criterium used to filter the column refer to by the 'by' argument. Current options are 'max' (maximum) and 'min' (minimum). Default is 'max'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>Numeric. Controls whether parallel computing is applied.
It specifies the number of cores to be used. Default is 1 (i.e. no parallel computing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pb</code></td>
<td>
<p>Logical argument to control progress bar. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function removes ambiguous detections keeping only the one that maximizes a criterium given by 'filter'. By default it keeps the detection with the highest overlap to the reference signal. It works on the output of <code>label_detection</code>. Useful when several detections match the same reference as in the case of template detection with multiple templates (see <code>template_detector</code>).
</p>


<h3>Value</h3>

<p>A data frame or selection table (if 'detection' was also a selection table, warbleR package's format, see <code>selection_table</code>) as in 'X' but removing ambiguous detections (split and merged positives).
</p>


<h3>Author(s)</h3>

<p>Marcelo Araya-Salas (<a href="mailto:marcelo.araya@ucr.ac.cr">marcelo.araya@ucr.ac.cr</a>).
</p>


<h3>References</h3>

<p>#' Araya-Salas, M., Smith-Vidaurre, G., Chaverri, G., Brenes, J. C., Chirino, F., Elizondo-Calvo, J., &amp; Rico-Guevara, A. 2022. ohun: an R package for diagnosing and optimizing automatic sound event detection. BioRxiv, 2022.12.13.520253. https://doi.org/10.1101/2022.12.13.520253
</p>


<h3>See Also</h3>

<p><code>label_detection</code>, <code>template_detector</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
  # load example data
  data("lbh1", "lbh_reference")

  # save sound files
  tuneR::writeWave(lbh1, file.path(tempdir(), "lbh2.wav"))

  # template for the first sound file in 'lbh_reference'
  templ1 &lt;- lbh_reference[1, ]

  # generate template correlations
  tc &lt;- template_correlator(
    templates = templ1, path = tempdir(),
    files = "lbh2.wav"
  )

  # template detection
  td &lt;- template_detector(template.correlations = tc, threshold = 0.12)

  # this detection generates 2 split positives
  diagnose_detection(
    reference = lbh_reference[lbh_reference == "lbh2.wav", ],
    detection = td
  )

  # label detection
  ltd &lt;- label_detection(
    reference = lbh_reference[lbh_reference == "lbh2.wav", ],
    detection = td
  )

  # now they can be filter to keep the detection with the highest score for each split
  ftd &lt;- consensus_detection(ltd, by = "scores")

  # splits must be 0
  diagnose_detection(
    reference = lbh_reference[lbh_reference == "lbh2.wav", ],
    detection = ftd
  )
}

</code></pre>


</div>