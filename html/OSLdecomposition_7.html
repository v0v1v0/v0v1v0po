<div class="container">

<table style="width: 100%;"><tr>
<td>plot_PhotoCrosssections</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot comparison of CW-OSL component photoionisation cross sections of different models</h2>

<h3>Description</h3>

<p>This function takes the <code>output.complex = TRUE</code> output of fit_OSLcurve and draws the
photoionisation cross sections of different models in relation to each other.
If a stimulation wavelength between 465 and 480 nm was chosen,
the photoionisation cross sections are also set in relation to literature values
from Singarayer and Bailey (2003), Jain et al. (2003) and Durcan and Duller (2011).
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_PhotoCrosssections(
  fit.list,
  stimulation.intensity = NULL,
  stimulation.wavelength = NULL,
  K.selected = NULL,
  title = NULL,
  hide.plot = FALSE,
  filename = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit.list</code></td>
<td>
<p>list (<strong>required</strong>):
Output object of fit_OSLcurve. The object must be created with the setting <code>output.complex = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stimulation.intensity</code></td>
<td>
<p>numeric (<em>optional</em>):
Intensity of optical stimulation in <em>mW / cm²</em>. Used to calculate the photoionisation cross sections.
If not given, the input value for fit_OSLcurve is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stimulation.wavelength</code></td>
<td>
<p>numeric (<em>optional</em>):
Wavelength of optical stimulation in nm. Used to calculate the photoionisation cross sections.
If not given, the input value for fit_OSLcurve is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.selected</code></td>
<td>
<p>numeric (<em>optional</em>):
Draws a red rectangle around the <code>K = K.selected</code> row, thus highlighting the model of choice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>character (<em>with default</em>):
Plot title. Set <code>title = NULL</code> for no title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide.plot</code></td>
<td>
<p>logical (<em>with default</em>):
If true, plot is not drawn but can still be saved as file or caught by <code>A &lt;- plot_PhotoCrosssections(...)</code>.
If caught, the plot can be drawn manually for example by using gridExtra::grid.arrange.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>character (<em>optional</em>):
File name or path to save the plot as image. If just a file name is given, the image is
saved in the working directory. The image type is chosen by the file ending. Both, vector images
as well as pixel images are possible. Allowed are <code>.pdf</code>, <code>.eps</code>, <code>.svg</code> (vector graphics),
<code>.jpg</code>, <code>.png</code>, <code>.bmp</code> (pixel graphics) and more, see ggplot2::ggsave.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The photoionisation cross section ranges of the reference components are defined as following:
</p>

<table>
<tr>
<td style="text-align: left;">
<strong>Component</strong> </td>
<td style="text-align: left;"> <strong>Lower limit (cm^2)</strong> </td>
<td style="text-align: left;"> <strong>Upper limit (cm^2)</strong>
</td>
</tr>
<tr>
<td style="text-align: left;">
Ultrafast </td>
<td style="text-align: left;"> 1e-16 </td>
<td style="text-align: left;"> 1e-15 </td>
</tr>
<tr>
<td style="text-align: left;">
Fast </td>
<td style="text-align: left;"> 1.9e-17 </td>
<td style="text-align: left;"> 3.1e-17 </td>
</tr>
<tr>
<td style="text-align: left;">
Medium </td>
<td style="text-align: left;"> 3e-18 </td>
<td style="text-align: left;"> 9e-18 </td>
</tr>
<tr>
<td style="text-align: left;">
Slow1 </td>
<td style="text-align: left;"> 1e-18 </td>
<td style="text-align: left;"> 1.85e-18 </td>
</tr>
<tr>
<td style="text-align: left;">
Slow2 </td>
<td style="text-align: left;"> 1.1e-19 </td>
<td style="text-align: left;"> 4e-19 </td>
</tr>
<tr>
<td style="text-align: left;">
Slow3 </td>
<td style="text-align: left;"> 1e-20 </td>
<td style="text-align: left;"> 4.67e-20 </td>
</tr>
<tr>
<td style="text-align: left;">
Slow4 </td>
<td style="text-align: left;"> 1e-21 </td>
<td style="text-align: left;"> 1e-20
</td>
</tr>
</table>
<h3>Value</h3>

<p>An invisible ggplot2::ggplot object containing the diagram will returned. "Invisible" means, the no value
will be returned (e.g. no console printout) if the function is not assigned to a variable via <code style="white-space: pre;">⁠&lt;-⁠</code>.
If the function is assigned, the returned object can be further manipulated by ggplot2-package methods
or manually drawn by various functions like for example gridExtra::grid.arrange.
</p>


<h3>Last updates</h3>

<p>2020-11-04, DM: Added roxygen documentation
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstraß, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Durcan, J.A., Duller, G.A.T., 2011. The fast ratio: A rapid measure for testing the dominance of the fast component in the initial OSL signal from quartz. Radiation Measurements 46, 1065–1072.
</p>
<p>Jain, M., Murray, A.S., Bøtter-Jensen, L., 2003. Characterisation of blue-light stimulated luminescence components in different quartz samples: implications for dose measurement. Radiation Measurements 37, 441–449.
</p>
<p>Singarayer, J.S., Bailey, R.M., 2003. Further investigations of the quartz optically stimulated luminescence components using linear modulation.
Radiation Measurements, Proceedings of the 10th international Conference on Luminescence and Electron-Spin Resonance Dating (LED 2002) 37, 451–458.
</p>


<h3>See Also</h3>

<p>fit_OSLcurve, RLum.OSL_global_fitting
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
name &lt;- c("fast", "slow")
lambda &lt;- c(2, 0.02)
n &lt;- c(1e6, 5e7)

# Build a component table
components &lt;- data.frame(name, lambda, n)

# Simulate the CW-OSL curve and add some signal noise
curve &lt;- simulate_OSLcomponents(components, simulate.curve = TRUE, add.poisson.noise = TRUE)

# Perform nonlinear regression at the simulated curve
fit_results &lt;- fit_OSLcurve(curve, K.max = 2, output.complex = TRUE)

# Plot the fitting iterations and set them into context
plot_PhotoCrosssections(fit_results)


</code></pre>


</div>