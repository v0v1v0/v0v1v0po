<div class="container">

<table style="width: 100%;"><tr>
<td>mxExpectationLISREL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create MxExpectationLISREL Object</h2>

<h3>Description</h3>

<p>This function creates a new MxExpectationLISREL object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mxExpectationLISREL(LX=NA, LY=NA, BE=NA, GA=NA, PH=NA, PS=NA, TD=NA, TE=NA, TH=NA,
                    TX = NA, TY = NA, KA = NA, AL = NA,
                    dimnames = NA, thresholds = NA,
	 threshnames = deprecated(), verbose=0L, ...,
  expectedCovariance=NULL, expectedMean=NULL, discrete = as.character(NA))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>LX</code></td>
<td>
<p>An optional character string indicating the name of the 'LX' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LY</code></td>
<td>
<p>An optional character string indicating the name of the 'LY' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BE</code></td>
<td>
<p>An optional character string indicating the name of the 'BE' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GA</code></td>
<td>
<p>An optional character string indicating the name of the 'GA' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PH</code></td>
<td>
<p>An optional character string indicating the name of the 'PH' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PS</code></td>
<td>
<p>An optional character string indicating the name of the 'PS' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TD</code></td>
<td>
<p>An optional character string indicating the name of the 'TD' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TE</code></td>
<td>
<p>An optional character string indicating the name of the 'TE' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TH</code></td>
<td>
<p>An optional character string indicating the name of the 'TH' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TX</code></td>
<td>
<p>An optional character string indicating the name of the 'TX' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TY</code></td>
<td>
<p>An optional character string indicating the name of the 'TY' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KA</code></td>
<td>
<p>An optional character string indicating the name of the 'KA' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AL</code></td>
<td>
<p>An optional character string indicating the name of the 'AL' matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimnames</code></td>
<td>
<p>An optional character vector that is currently ignored</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>An optional character string indicating the name of the thresholds matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshnames</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>integer. Level of runtime diagnostic output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.  Forces remaining arguments to be specified by name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectedCovariance</code></td>
<td>
<p>An optional character string indicating the
name of a matrix for the model implied covariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectedMean</code></td>
<td>
<p>An optional character string indicating the name
of a matrix for the model implied mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrete</code></td>
<td>
<p>An optional character string indicating the name of the discrete matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Expectation functions define the way that model expectations are calculated. The mxExpectationLISREL calculates the expected covariance and means of a given MxData object given a LISREL model. This model is defined by LInear Structural RELations (LISREL; Jöreskog &amp; Sörbom, 1982, 1996).  Arguments 'LX' through 'AL' must refer to MxMatrix objects with the associated properties of their respective matrices in the LISREL modeling approach.
</p>
<p>The full LISREL specification has 13 matrices and is sometimes called the extended LISREL model.  It is defined by the following equations.
</p>
<p style="text-align: center;"><code class="reqn">\eta = \alpha + B \eta + \Gamma \xi + \zeta</code>
</p>

<p style="text-align: center;"><code class="reqn">y = \tau_y + \Lambda_y \eta + \epsilon</code>
</p>

<p style="text-align: center;"><code class="reqn">x = \tau_x + \Lambda_x \xi + \delta</code>
</p>

<p>The table below is provided as a quick reference to the numerous matrices in LISREL models.  Note that NX is the number of manifest exogenous (independent) variables, the number of Xs.  NY is the number of manifest endogenous (dependent) variables, the number of Ys.  NK is the number of latent exogenous variables, the number of Ksis or Xis.  NE is the number of latent endogenous variables, the number of etas.
</p>

<table>
<tr>
<td style="text-align: center;">
Matrix </td>
<td style="text-align: left;"> Word </td>
<td style="text-align: center;"> Abbreviation </td>
<td style="text-align: center;"> Dimensions </td>
<td style="text-align: center;"> Expression</td>
<td style="text-align: left;"> Description </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\Lambda_x</code> </td>
<td style="text-align: left;"> Lambda x </td>
<td style="text-align: center;"> LX </td>
<td style="text-align: center;"> NX x NK </td>
<td style="text-align: center;"> </td>
<td style="text-align: left;"> Exogenous Factor Loading Matrix </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\Lambda_y</code> </td>
<td style="text-align: left;"> Lambda y </td>
<td style="text-align: center;"> LY </td>
<td style="text-align: center;"> NY x NE </td>
<td style="text-align: center;"> </td>
<td style="text-align: left;"> Endogenous Factor Loading Matrix</td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">B</code> </td>
<td style="text-align: left;"> Beta </td>
<td style="text-align: center;"> BE </td>
<td style="text-align: center;"> NE x NE </td>
<td style="text-align: center;"> </td>
<td style="text-align: left;"> Regressions of Latent Endogenous Variables Predicting Endogenous Variables</td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\Gamma</code> </td>
<td style="text-align: left;"> Gamma </td>
<td style="text-align: center;"> GA </td>
<td style="text-align: center;"> NE x NK </td>
<td style="text-align: center;"> </td>
<td style="text-align: left;"> Regressions of Latent Exogenous Variables Predicting Endogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\Phi</code> </td>
<td style="text-align: left;"> Phi </td>
<td style="text-align: center;"> PH </td>
<td style="text-align: center;"> NK x NK </td>
<td style="text-align: center;"> cov(<code class="reqn">\xi</code>) </td>
<td style="text-align: left;"> Covariance Matrix of Latent Exogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\Psi</code> </td>
<td style="text-align: left;"> Psi </td>
<td style="text-align: center;"> PS </td>
<td style="text-align: center;"> NE x NE </td>
<td style="text-align: center;"> cov(<code class="reqn">\zeta</code>) </td>
<td style="text-align: left;"> Residual Covariance Matrix of Latent Endogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\Theta_{\delta}</code> </td>
<td style="text-align: left;"> Theta delta </td>
<td style="text-align: center;"> TD </td>
<td style="text-align: center;"> NX x NX </td>
<td style="text-align: center;"> cov(<code class="reqn">\delta</code>) </td>
<td style="text-align: left;"> Residual Covariance Matrix of Manifest Exogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\Theta_{\epsilon}</code> </td>
<td style="text-align: left;"> Theta epsilon </td>
<td style="text-align: center;"> TE </td>
<td style="text-align: center;"> NY x NY </td>
<td style="text-align: center;"> cov(<code class="reqn">\epsilon</code>) </td>
<td style="text-align: left;"> Residual Covariance Matrix of Manifest Endogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\Theta_{\delta \epsilon}</code> </td>
<td style="text-align: left;"> Theta delta epsilson </td>
<td style="text-align: center;"> TH </td>
<td style="text-align: center;"> NX x NY </td>
<td style="text-align: center;"> cov(<code class="reqn">\delta, \epsilon</code>) </td>
<td style="text-align: left;"> Residual Covariance Matrix of Manifest Exogenous with Endogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\tau_x</code> </td>
<td style="text-align: left;"> tau x </td>
<td style="text-align: center;"> TX </td>
<td style="text-align: center;"> NX x 1 </td>
<td style="text-align: center;"> </td>
<td style="text-align: left;"> Residual Means of Manifest Exogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\tau_y</code> </td>
<td style="text-align: left;"> tau y </td>
<td style="text-align: center;"> TY </td>
<td style="text-align: center;"> NY x 1 </td>
<td style="text-align: center;"> </td>
<td style="text-align: left;"> Residual Means of Manifest Endogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\kappa</code> </td>
<td style="text-align: left;"> kappa </td>
<td style="text-align: center;"> KA </td>
<td style="text-align: center;"> NK x 1 </td>
<td style="text-align: center;"> mean(<code class="reqn">\xi</code>) </td>
<td style="text-align: left;"> Means of Latent Exogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
<code class="reqn">\alpha</code> </td>
<td style="text-align: left;"> alpha </td>
<td style="text-align: center;"> AL </td>
<td style="text-align: center;"> NE x 1 </td>
<td style="text-align: center;"> </td>
<td style="text-align: left;"> Residual Means of Latent Endogenous Variables </td>
</tr>
<tr>
<td style="text-align: center;">
</td>
</tr>
</table>
<p>From the extended LISREL model, several submodels can be defined.  Subtypes of the LISREL model are defined by setting some of the arguments of the LISREL expectation function to NA.  Note that because the default values of each LISREL matrix is NA, setting a matrix to NA can be accomplished by simply not giving it any other value.
</p>
<p>The first submodel is the LISREL model without means.
</p>
<p style="text-align: center;"><code class="reqn">\eta = B \eta + \Gamma \xi + \zeta</code>
</p>

<p style="text-align: center;"><code class="reqn">y = \Lambda_y \eta + \epsilon</code>
</p>

<p style="text-align: center;"><code class="reqn">x = \Lambda_x \xi + \delta</code>
</p>

<p>The LISREL model without means requires 9 matrices: LX, LY, BE, GA, PH, PS, TD, TE, and TH.  Hence this LISREL model has TX, TY, KA, and AL as NA.  This can be accomplished be leaving these matrices at their default values.
</p>
<p>The TX, TY, KA, and AL matrices must be specified if either the mxData type is “cov” or “cor” and a means vector is provided, or if the mxData type is “raw”.  Otherwise the TX, TY, KA, and AL matrices are ignored and the model without means is estimated.
</p>
<p>A second submodel involves only endogenous variables.
</p>
<p style="text-align: center;"><code class="reqn">\eta = B \eta + \zeta</code>
</p>

<p style="text-align: center;"><code class="reqn">y = \Lambda_y \eta + \epsilon</code>
</p>

<p>The endogenous-only LISREL model requires 4 matrices: LY, BE, PS, and TE.  The LX, GA, PH, TD, and TH must be NA in this case.  However, means can also be specified, allowing TY and AL if the data are raw or if observed means are provided.
</p>
<p>Another submodel involves only exogenous variables.
</p>
<p style="text-align: center;"><code class="reqn">x = \Lambda_x \xi + \delta</code>
</p>

<p>The exogenous-model model requires 3 matrices: LX, PH, and TD.  The LY, BE, GA, PS, TE, and TH matrices must be NA.  However, means can also be specified, allowing TX and KA if the data are raw or if observed means are provided.
</p>
<p>The model that is run depends on the matrices that are not NA.  If all 9 matrices are not NA, then the full model is run.  If only the 4 endogenous matrices are not NA, then the endogenous-only model is run.  If only the 3 exogenous matrices are not NA, then the exogenous-only model is run.  If some endogenous and exogenous matrices are not NA, but not all of them, then appropriate errors are thrown.  Means are included in the model whenever their matrices are provided.
</p>

<p>The MxMatrix objects included as arguments may be of any type, but should have the properties described above. The mxExpectationLISREL will not return an error for incorrect specification, but incorrect specification will likely lead to estimation problems or errors in the mxRun function.
</p>
<p>Like the mxExpectationRAM, the mxExpectationLISREL evaluates with respect to an MxData object. The MxData object need not be referenced in the mxExpectationLISREL function, but must be included in the MxModel object. mxExpectationLISREL requires that the 'type' argument in the associated MxData object be equal to 'cov', 'cor', or 'raw'.
</p>
<p>To evaluate, place mxExpectationLISREL objects, the mxData object for which the expected covariance approximates, referenced MxAlgebra and MxMatrix objects, and optional MxBounds and MxConstraint objects in an MxModel object. This model may then be evaluated using the mxRun function. The results of the optimization can be found in the 'output' slot of the resulting model, and may be obtained using the mxEval function.
</p>


<h3>Value</h3>

<p>Returns a new MxExpectationLISREL object. One and only one MxExpectationLISREL object can be included with models using one and only one fit function object (e.g., MxFitFunctionML) and with referenced MxAlgebra, MxData and MxMatrix objects.
</p>


<h3>References</h3>

<p>Jöreskog, K. G. &amp; Sörbom, D. (1996). LISREL 8: User's Reference Guide. Lincolnwood, IL: Scientific Software International.
</p>
<p>Jöreskog, K. G. &amp; Sörbom, D. (1982). Recent developments in structural equation modeling. <em>Journal of Marketing Research, 19,</em> 404-416.
</p>
<p>The OpenMx User's guide can be found at <a href="https://openmx.ssri.psu.edu/documentation/">https://openmx.ssri.psu.edu/documentation/</a>.
</p>


<h3>See Also</h3>

<p><code>demo("LISRELJointFactorModel")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">   
# Create and fit a model using mxExpectationLISREL, and mxFitFunctionML

library(OpenMx)

vNames &lt;- paste("v",as.character(1:6),sep="")
dimList &lt;- list(vNames, vNames)
covData &lt;- matrix(
  c(0.9223099, 0.1862938, 0.4374359, 0.8959973, 0.9928430, 0.5320662,
    0.1862938, 0.2889364, 0.3927790, 0.3321639, 0.3371594, 0.4476898,
    0.4374359, 0.3927790, 1.0069552, 0.6918755, 0.7482155, 0.9013952,
    0.8959973, 0.3321639, 0.6918755, 1.8059956, 1.6142005, 0.8040448,
    0.9928430, 0.3371594, 0.7482155, 1.6142005, 1.9223567, 0.8777786,
    0.5320662, 0.4476898, 0.9013952, 0.8040448, 0.8777786, 1.3997558
    ), nrow=6, ncol=6, byrow=TRUE, dimnames=dimList)

# Create LISREL matrices

mLX &lt;- mxMatrix("Full", values=c(.5, .6, .8, rep(0, 6), .4, .7, .5),
          name="LX", nrow=6, ncol=2,
          free=c(TRUE,TRUE,TRUE,rep(FALSE, 6),TRUE,TRUE,TRUE),
          dimnames=list(vNames, c("x1","x2")))
mTD &lt;- mxMatrix("Diag", values=c(rep(.2, 6)), 
          name="TD", nrow=6, ncol=6, free=TRUE,
          dimnames=dimList)
mPH &lt;- mxMatrix("Symm", values=c(1, .3, 1), 
          name="PH", nrow=2, ncol=2, free=c(FALSE, TRUE, FALSE),
          dimnames=list(c("x1","x2"),c("x1","x2")))

# Create a LISREL expectation with LX, TD, and PH matrix names

expFunction &lt;- mxExpectationLISREL(LX="LX", TD="TD", PH="PH")

# Create fit function and data

tmpData &lt;- mxData(observed=covData, type="cov", numObs=100)
fitFunction &lt;- mxFitFunctionML()

# Create the model, fit it, and print a summary.

tmpModel &lt;- mxModel(model="exampleModel",
                    mLX, mTD, mPH, expFunction, fitFunction, tmpData)
tmpModelOut &lt;- mxRun(tmpModel)
summary(tmpModelOut)


#--------------------------------------
# Fit factor model with means

require(OpenMx)

data(demoOneFactor)
nvar &lt;- ncol(demoOneFactor)
varnames &lt;- colnames(demoOneFactor)

factorMeans &lt;- mxMatrix("Zero", 1, 1, name="Kappa",
                        dimnames=list("F1", NA))
xIntercepts &lt;- mxMatrix("Full", nvar, 1, free=TRUE, name="TauX",
                        dimnames=list(varnames, NA))
factorLoadings &lt;- mxMatrix("Full", nvar, 1, TRUE, .6, name="LambdaX",
                           labels=paste("lambda", 1:nvar, sep=""),
                           dimnames=list(varnames, "F1"))
factorCovariance &lt;- mxMatrix("Diag", 1, 1, FALSE, 1, name="Phi")
xResidualVariance &lt;- mxMatrix("Diag", nvar, nvar, TRUE, .2, name="ThetaDelta",
                              labels=paste("theta", 1:nvar, sep=""))

liModel &lt;- mxModel(model="LISREL Factor Model",
	factorMeans, xIntercepts, factorLoadings,
	factorCovariance, xResidualVariance,
	mxExpectationLISREL(LX="LambdaX", PH="Phi",
		TD="ThetaDelta", TX="TauX", KA="Kappa"),
	mxFitFunctionML(),
	mxData(cov(demoOneFactor), "cov",
		means=colMeans(demoOneFactor), numObs=nrow(demoOneFactor))
)

liRun &lt;- mxRun(liModel)

summary(liRun)
</code></pre>


</div>