<div class="container">

<table style="width: 100%;"><tr>
<td>adjR2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gridwise adjusted R2 for O2PLS</h2>

<h3>Description</h3>

<p>For (a grid of) values for <code>a</code>, <code>nx</code> and <code>ny</code>, <code>loocv</code> calculates the R2 of the joint part. Parallel computing is supported on Windows with package <code>parallel</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adjR2(
  X,
  Y,
  a = 1:2,
  a2 = 1,
  b2 = 1,
  func = o2m,
  parall = F,
  cl = NULL,
  stripped = TRUE,
  p_thresh = 3000,
  q_thresh = p_thresh,
  tol = 1e-10,
  max_iterations = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric matrix. Vectors will be coerced to matrix with <code>as.matrix</code> (if this is possible)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric matrix. Vectors will be coerced to matrix with <code>as.matrix</code> (if this is possible)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Vector of integers. Contains the numbers of joint components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2</code></td>
<td>
<p>Vector of integers. Contains the numbers of orthogonal components in <code class="reqn">X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b2</code></td>
<td>
<p>Vector of integers. Contains the numbers of orthogonal components in <code class="reqn">Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>Function to fit the O2PLS model with. Only <code>o2m</code> and <code>o2m_stripped</code> are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parall</code></td>
<td>
<p>Integer. Should a parallel cluster be set up using package <code>parallel</code> (Windows)? Best is to leave it to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Object of class '<code>cluster</code>'. If parall is <code>TRUE</code> and <code>cl</code> is not <code>NULL</code>, calculations are parallelized over workers in cl.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stripped</code></td>
<td>
<p>Logical. Use the stripped version of o2m (usually when cross-validating)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_thresh</code></td>
<td>
<p>Integer. If <code>X</code> has more than <code>p_thresh</code> columns, a power method optimization is used, see <code>o2m2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_thresh</code></td>
<td>
<p>Integer. If <code>Y</code> has more than <code>q_thresh</code> columns, a power method optimization is used, see <code>o2m2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Double. Threshold for which the NIPALS method is deemed converged. Must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iterations</code></td>
<td>
<p>Integer. Maximum number of iterations for the NIPALS method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The use of this function is to calculate the R2 of the joint part, while varying the number of orthogonal components. Adding more joint components will increase the R2!
</p>
<p>A parallelized version is built in -tested on windows-, use package <code>parallel</code> and set <code>parall=TRUE</code> to activate this. There should not be already a cluster object with the name <code>cl</code>.
In case of some error, don't forget to invoke <code>stopCluster(cl)</code> to end the cluster. See Task Manager (Windows) to verify that the workers are spanned/ended.
</p>
<p>See <code>loocv</code> for more intuition.
</p>


<h3>Value</h3>

<p>Matrix with two rows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>adjR2X</code></td>
<td>
<p>Contains the joint R2 in X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjR2Y</code></td>
<td>
<p>Contains the joint R2 in Y</p>
</td>
</tr>
</table>
</div>