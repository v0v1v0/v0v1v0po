<div class="container">

<table style="width: 100%;"><tr>
<td>power.3m</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Budget and/or sample size, power, MDES calculation for
three-level MRTs detecting main effects</h2>

<h3>Description</h3>

<p>This function can calculate required budget for desired power,
power or minimum detectable effect size (MDES) under fixed budget
for three-level multisite randomized trials (MRTs).
It also can perform conventional power analyses
(e.g., required sample size, power, and MDES calculation).
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.3m(
  cost.model = TRUE,
  expr = NULL,
  constraint = NULL,
  sig.level = 0.05,
  two.tailed = TRUE,
  d = NULL,
  power = NULL,
  m = NULL,
  n = NULL,
  J = NULL,
  K = NULL,
  p = NULL,
  icc2 = NULL,
  icc3 = NULL,
  r12 = NULL,
  r22 = NULL,
  r32m = NULL,
  q = NULL,
  c1 = NULL,
  c2 = NULL,
  c3 = NULL,
  c1t = NULL,
  c2t = NULL,
  omega = NULL,
  dlim = NULL,
  powerlim = NULL,
  Klim = NULL,
  mlim = NULL,
  rounded = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cost.model</code></td>
<td>
<p>Logical; power analyses accommodating costs and budget
(e.g., required budget for desired power, power/MDES under fixed budget)
if TRUE, otherwise conventional power analyses
(e.g., required sample size, power, or MDES calculation); default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>Returned objects from function <code>od.3m</code>; default is NULL;
if <code>expr</code> is specified, parameter values of <code>icc2</code>, <code>icc3</code>,
<code>r12</code>, <code>r22</code>, <code>r32m</code>,
<code>c1</code>, <code>c2</code>, <code>c3</code>,
<code>c1t</code>, <code>c2t</code>, <code>p</code>, <code>n</code>, and <code>J</code>
used or solved in function <code>od.3m</code> will
be passed to current function;
only the values of <code>p</code>, <code>n</code>, and/or <code>J</code> that specified or solved in
function <code>od.3m</code> can be overwritten
if <code>constraint</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint</code></td>
<td>
<p>Specify the constrained values of <code>p</code>, <code>n</code>, and/or <code>J</code>,
in list format to overwrite
those from <code>expr</code>; default value is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>Significance level or type I error rate, default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.tailed</code></td>
<td>
<p>Logical; two-tailed tests if TRUE,
otherwise one-tailed tests; default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Effect size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Statistical power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Total budget.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The level-1 sample size per level-2 unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>The level-2 sample size per level-3 unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The level-3 sample size per level-4 unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The proportion of level-2 units to be assigned to treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icc2</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icc3</code></td>
<td>
<p>The unconditional intraclass correlation coefficient (ICC) at level 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r12</code></td>
<td>
<p>The proportion of level-1 variance explained by covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r22</code></td>
<td>
<p>The proportion of level-2 variance explained by covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r32m</code></td>
<td>
<p>The proportion of variance of site-specific treatment effect explained by covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The number of covariates at level 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>The cost of sampling one level-1 unit in control condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c2</code></td>
<td>
<p>The cost of sampling one level-2 unit in control condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c3</code></td>
<td>
<p>The cost of sampling one level-3 unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1t</code></td>
<td>
<p>The cost of sampling one level-1 unit in treatment condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c2t</code></td>
<td>
<p>The cost of sampling one level-2 unit in treatment condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>The standardized variance of site-specific treatment effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dlim</code></td>
<td>
<p>The range for solving the root of effect size (<code>d</code>) numerically,
default value is c(0, 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powerlim</code></td>
<td>
<p>The range for solving the root of power (<code>power</code>) numerically,
default value is c(1e-10, 1 - 1e-10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Klim</code></td>
<td>
<p>The range for searching the root of level-3 sample size (<code>K</code>) numerically,
default value is c(4, 1e+10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mlim</code></td>
<td>
<p>The range for searching the root of budget (<code>m</code>) numerically,
default is the costs sampling <code>Klim</code> level-3 units
or c(4 * Kcost, 1e+10 * Kcost) with Kcost =
((1 - p) * (c1 * n * J + c2 * J) +
p * (c1t * n * J + c2t * J) + c3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rounded</code></td>
<td>
<p>Logical; round the values of <code>p</code>, <code>n</code>/<code>J</code>/<code>K</code>
that are from functions <code>od.4</code>
to two decimal places and integer, respectively if TRUE,
otherwise no rounding; default value is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Required budget (and/or required level-3 sample size), statistical power, or MDES
depending on the specification of parameters.
The function also returns the function name, design type,
and parameters used in the calculation.
</p>


<h3>References</h3>

<p>Shen, Z., &amp; Kelcey, B. (in press). Optimal sampling ratios in three-level
multisite experiments. Journal of Research on Educational Effectiveness.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Unconstrained optimal design #---------
  myod1 &lt;- od.3m(icc2 = 0.2, icc3 = 0.1, omega = 0.02,
              r12 = 0.5, r22 = 0.5, r32m = 0.5,
              c1 = 1, c2 = 5,
              c1t = 1, c2t = 200, c3 = 200,
              varlim = c(0, 0.005))
  myod1$out # n = 13.1, J = 15.3, p = 0.23

# ------- Power analyses by default considering costs and budget -------
# Required budget and sample size
  mym.1 &lt;- power.3m(expr = myod1, d = 0.2, q = 1, power = 0.8)
  mym.1$out  # m = 15491, K = 13.6
  # mym.1$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  mym.1 &lt;- power.3m(d = 0.2, power = 0.8, q = 1,
                 icc2 = 0.2, icc3 = 0.1, omega = 0.02,
                  r12 = 0.5, r22 = 0.5, r32m = 0.5,
                  c1 = 1, c2 = 5,
                  c1t = 1, c2t = 200, c3 = 200,
                  n = 13, J = 15, p = 0.23)
# Required budget and sample size with constrained p
  mym.2 &lt;- power.3m(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5))
  mym.2$out  # m = 21072, K = 10.9
# Required budget and sample size with constrained p and n
  mym.3 &lt;- power.3m(expr = myod1, d = 0.2, q = 1, power = 0.8,
                 constraint = list(p = 0.5, n = 20))
  mym.3$out  # m = 21252, K = 10.4

# Power calculation
  mypower &lt;- power.3m(expr = myod1, q = 1, d = 0.2, m = 15491)
  mypower$out  # power = 0.80
# Power calculation under constrained p (p = 0.5)
  mypower.1 &lt;- power.3m(expr = myod1, q = 1, d = 0.2, m = 15491,
                 constraint = list(p = 0.5))
  mypower.1$out  # power = 0.62

# MDES calculation
  mymdes &lt;- power.3m(expr = myod1, q = 1, power = 0.80, m = 15491)
  mymdes$out  # d = 0.20


# ------- Conventional power analyses with cost.model = FALSE-------
# Required sample size
  myK &lt;- power.3m(cost.model = FALSE, expr = myod1, d = 0.2, q = 1, power = 0.8)
  myK$out  # K = 13.6
  # myK$par  # parameters and their values used for the function
# Or, equivalently, specify every argument in the function
  myK &lt;- power.3m(cost.model = FALSE, d = 0.2, power = 0.8, q = 1,
                  icc2 = 0.2, icc3 = 0.1, omega = 0.02,
                  r12 = 0.5, r22 = 0.5, r32m = 0.5,
                  c1 = 1, c2 = 5,
                  c1t = 1, c2t = 200, c3 = 200,
                  n = 13, J = 15, p = 0.23)

# Power calculation
  mypower1 &lt;- power.3m(cost.model = FALSE, expr = myod1, K = 13.6, d = 0.2, q = 1)
  mypower1$out  # power = 0.80

# MDES calculation
  mymdes1 &lt;- power.3m(cost.model = FALSE, expr = myod1, K = 13.6, power = 0.8, q = 1)
  mymdes1$out  # d = 0.20

</code></pre>


</div>